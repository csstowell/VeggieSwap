{% extends 'base.html' %}
{% block title %}
Marketplace
{% endblock %}



{% block body %}

<script>
  /*
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition);
    } else { 
      map.innerHTML = "Geolocation is not supported by this browser.";
    }
  
  
  function showPosition(position) {
      map.innerHTML = "Latitude: " + position.coords.latitude + 
    "<br>Longitude: " + position.coords.longitude;
  }
  */
  function initMap() {
    // The location of SF
    const sf = { lat: 37.753506, lng: -122.433315 };
    // The map, centered at SF
    const map = new google.maps.Map(document.getElementById("map"), {
      zoom: 12,
      center: sf,
    });
    let lat = 0;
    let lng = 0;
    console.log('HERE #####: item')

    lat = 0; //exchange_items.user.lat
    lng = 0; //exchange_items.user.lng
    if (lat != 'None') {
      const coord = {
        lat: lat,
        lng: lng
      }
      new google.maps.Marker({
        position: coord,
        label: 'exchange_items.user.username',
        title: 'title',
        map: map
      });

    }


    // The marker, positioned at SF
    const marker = new google.maps.Marker({
      position: sf,
      map: map,
    });

    // Add circle overlay and bind to marker
    var circle = new google.maps.Circle({
      map: map,
      radius: 1609,    // 1 miles in metres
      fillColor: 'green',
      fillOpacity: 0.15
    });
    circle.bindTo('center', marker, 'position');
  }

</script>





<div class="container">
  <div class="row">
    {% block form %}
    <form method="get">
      <label for="distance">Select distance:</label>
      <select class="btn btn-secondary " id="distance" name="distance" required>
          <option value="0.5">0.5 miles</option>
          <option value="1">1.0 miles</option>
          <option value="1.5">1.5 miles</option>
          <option value="2.0">2.0 miles</option>
          <option value="3.0">3.0 miles</option>
      </select>
      <button class="btn btn-secondary searchButton" type="submit" href="/exchange/">Search</button>
      {% endblock%}
  </div>
  
  <div class="row align-items-start">
    <div class="col-8">
      <div style="height: 100vh; width: 100%;">
        <div id="map" style="height:100%; width: 100%;"></div>
      </div>
    </div>
    <div class="col-4">
      {% for item in exchange_items %}
      {% include "produceEntry.html" %}
      {% endfor %}
    </div>
  </div>
</div>

<div class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Modal body text goes here.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Save changes</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
  Launch demo modal
</button>

<!-- AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg -->

<!-- Async script executes immediately and must be after any DOM elements used in callback. -->
<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDIYpD84hN93_pAL4oomppVemp3JYSvaRE&callback=initMap&libraries=&v=weekly&channel=2"
  async></script>


{% endblock %}